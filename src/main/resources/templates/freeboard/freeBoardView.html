<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>게시글 보기</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/header.css}">
  <link rel="stylesheet" th:href="@{/css/freeBoardView.css}"> <!-- boardview 전용 CSS 파일 -->
  <link rel="stylesheet" th:href="@{/css/footer.css}">
</head>
<body>
  <!-- 헤더 영역 -->
  <header th:replace="~{fragments/header :: header}"></header>

  <!-- 게시글 내용 영역 -->
  <section class="container my-5">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title mb-3" th:text="'게시글 제목'">게시글 제목</h4>
        <ul class="list-inline">
          <li class="list-inline-item"><strong>작성자:</strong> <span th:text="'작성자명'">작성자명</span></li>
          <li class="list-inline-item"><strong>작성일:</strong> <span th:text="'2024-10-01'">2024-10-01</span></li>
        </ul>
      </div>

      <!-- 사진 슬라이드 (Carousel) -->
      <div id="postCarousel" class="carousel slide" data-bs-ride="carousel">
        <!-- 점 네비게이션 -->
        <div class="carousel-indicators">
          <button type="button" data-bs-target="#postCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
          <button type="button" data-bs-target="#postCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
          <button type="button" data-bs-target="#postCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>

        <!-- 슬라이드 이미지 -->
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img th:src="@{/images/1.jpg}" class="d-block w-100" alt="게시글 사진 1" style="height: 400px; object-fit: cover;">
          </div>
          <div class="carousel-item">
            <img th:src="@{/images/2.jpg}" class="d-block w-100" alt="게시글 사진 2" style="height: 400px; object-fit: cover;">
          </div>
          <div class="carousel-item">
            <img th:src="@{/images/3.jpg}" class="d-block w-100" alt="게시글 사진 3" style="height: 400px; object-fit: cover;">
          </div>
        </div>

        <!-- 이전/다음 화살표 -->
        <button class="carousel-control-prev" type="button" data-bs-target="#postCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">이전</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#postCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">다음</span>
        </button>
      </div>

      <div class="card-body">
        <p class="card-text" th:text="'게시글 상세 내용'">게시글 상세 내용</p>
      </div>
    </div>

    <!-- 댓글 영역 -->
    <div class="mt-5">
      <h5>댓글</h5>

      <!-- 댓글 입력 -->
      <form th:action="@{/comment/add}" method="post">
        <div class="mb-3">
          <textarea class="form-control" name="commentContent" rows="3" placeholder="댓글을 입력하세요"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">댓글 작성</button>
      </form>

      <!-- 댓글 목록 -->
      <div class="comment-section mt-4">
        <!-- 댓글 -->
        <div class="comment mb-3">
          <strong th:text="'작성자명'">작성자명</strong> <span th:text="'2024-10-01'">2024-10-01</span>
          <p th:text="'댓글 내용'">댓글 내용</p>
          <button class="btn btn-sm btn-link reply-btn" data-comment-id="1">답글</button>

          <!-- 대댓글 (들여쓰기 적용) -->
          <div class="reply ms-4">
            <strong th:text="'작성자명'">작성자명</strong> <span th:text="'2024-10-01'">2024-10-01</span>
            <p th:text="'대댓글 내용'">대댓글 내용</p>
            <button class="btn btn-sm btn-link reply-btn" data-comment-id="2">답글</button>
          </div>

          <!-- 대댓글 입력 폼 -->
          <form th:action="@{/comment/reply}" method="post" class="reply-form mt-2 ms-4" style="display: none;">
            <input type="hidden" name="parentCommentId" value="1">
            <div class="mb-2">
              <textarea class="form-control" name="replyContent" rows="2" placeholder="답글을 입력하세요"></textarea>
            </div>
            <button type="submit" class="btn btn-sm btn-primary">답글 작성</button>
          </form>
        </div>
      </div>
    </div>
  </section>

  <!-- 푸터 영역 -->
  <footer th:replace="~{fragments/footer :: footer}"></footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/js/scripts.js"></script>

  <!-- 댓글 답글 토글 스크립트 -->
  <script>
    document.querySelectorAll('.reply-btn').forEach(button => {
      button.addEventListener('click', () => {
        const form = button.closest('.comment').querySelector('.reply-form');
        form.style.display = form.style.display === 'none' ? 'block' : 'none';
      });
    });
  </script>
</body>
</html>
