<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>게시글 보기</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link rel="stylesheet" th:href="@{/css/header.css}">
<link rel="stylesheet" th:href="@{/css/freeBoardView.css}">
<link rel="stylesheet" th:href="@{/css/footer.css}">
</head>
<body>
	<!-- 헤더 영역 -->
	<header th:replace="~{fragments/header :: header}"></header>

	<!-- 게시글 내용 영역 -->
	<section class="container my-5">
		<div class="card">
			<div class="card-header">
				<h4 class="card-title mb-3" th:text="${board.title}">게시글 제목</h4>
				  <!-- 수정 및 삭제 버튼 (작성자와 현재 로그인 사용자가 같을 때만 표시) -->
                <div th:if="${board.userId == userId}">
                    <a th:href="@{/freeboard/freeBoardUpdate/{id}(id=${board.id})}" class="btn btn-outline-warning btn-sm me-2">수정</a>
                     <a th:href="@{/freeboard/freeBoardDelete/{id}(id=${board.id})}" class="btn btn-outline-danger btn-sm">삭제</a>
                </div>
				<ul class="list-inline">
					<li class="list-inline-item"><strong>작성자:</strong> <span
						th:text="${board.userId}">작성자명</span></li>
					<li class="list-inline-item"><strong>작성일:</strong> <span
						th:text="${board.createdAt != null ? #temporals.format(board.createdAt, 'yyyy-MM-dd') : '날짜 없음'}"></span></li>
				</ul>
			</div>

			<div id="postCarousel" class="carousel slide" data-bs-ride="carousel">
				<!-- 점 네비게이션 -->
				<div class="carousel-indicators">
					<!-- 이미지 배열 크기만큼 동적으로 점 생성 -->
					<th:block th:each="image, iterStat : ${board.images}">
						<button type="button" data-bs-target="#postCarousel"
							th:data-bs-slide-to="${iterStat.index}"
							th:classappend="${iterStat.index == 0} ? 'active'"
							th:aria-current="${iterStat.index == 0} ? 'true' : 'false'"
							th:aria-label="'Slide ' + ${iterStat.index + 1}"></button>
					</th:block>
				</div>

				<!-- 슬라이드 이미지 -->
				<div class="carousel-inner">
					<th:block th:each="image, iterStat : ${board.images}">
						<div class="carousel-item"
							th:classappend="${iterStat.index == 0} ? 'active'">
							<!-- 이미지가 없을 때 기본 이미지 표시 -->
							<img
								th:src="@{/upload/{fileName}(fileName=${image?.saveFileName ?: 'default.jpg'})}"
								class="d-block w-100" th:alt="'Slide ' + ${iterStat.index + 1}">
						</div>
					</th:block>

					<!-- 이미지가 없을 때 기본 이미지 슬라이드 표시 -->
					<th:block th:if="${#lists.isEmpty(board.images)}">
						<div class="carousel-item active">
							<img th:src="@{/upload/default.jpg}" class="d-block w-100"
								alt="기본 이미지">
						</div>
					</th:block>
				</div>

				<!-- 이전/다음 화살표 -->
				<button class="carousel-control-prev" type="button"
					data-bs-target="#postCarousel" data-bs-slide="prev">
					<span class="carousel-control-prev-icon" aria-hidden="true"></span>
					<span class="visually-hidden">이전</span>
				</button>
				<button class="carousel-control-next" type="button"
					data-bs-target="#postCarousel" data-bs-slide="next">
					<span class="carousel-control-next-icon" aria-hidden="true"></span>
					<span class="visually-hidden">다음</span>
				</button>
			</div>

			<div class="card-body">
				<p class="card-text" th:text="${board.content}">게시글 상세 내용</p>
			</div>
		</div>
		
		<!-- 목록 버튼 추가 -->
        <div class="text-center my-4">
            <a th:href="@{/freeboard/freeBoardList}" class="btn btn-primary">게시글 리스트</a>
        </div>

		<!-- 댓글 영역 -->
		<div class="mt-5">
			<h5>댓글</h5>

			<!-- 댓글 입력 -->
			<form th:action="@{/comment/add}" method="post">
				<div class="mb-3">
					<textarea class="form-control" name="commentContent" rows="3"
						placeholder="댓글을 입력하세요"></textarea>
				</div>
				<button type="submit" class="btn btn-primary">댓글 작성</button>
			</form>

			<!-- 댓글 목록 -->
			<div class="comment-section mt-4">
				<div class="comment mb-3">
					<strong th:text="'작성자명'">작성자명</strong> <span th:text="'2024-10-01'">2024-10-01</span>
					<p th:text="'댓글 내용'">댓글 내용</p>
					<button class="btn btn-sm btn-link reply-btn" data-comment-id="1">답글</button>

					<div class="reply ms-4">
						<strong th:text="'작성자명'">작성자명</strong> <span
							th:text="'2024-10-01'">2024-10-01</span>
						<p th:text="'대댓글 내용'">대댓글 내용</p>
						<button class="btn btn-sm btn-link reply-btn" data-comment-id="2">답글</button>
					</div>

					<form th:action="@{/comment/reply}" method="post"
						class="reply-form mt-2 ms-4" style="display: none;">
						<input type="hidden" name="parentCommentId" value="1">
						<div class="mb-2">
							<textarea class="form-control" name="replyContent" rows="2"
								placeholder="답글을 입력하세요"></textarea>
						</div>
						<button type="submit" class="btn btn-sm btn-primary">답글
							작성</button>
					</form>
				</div>
			</div>
		</div>
	</section>

	<footer th:replace="~{fragments/footer :: footer}"></footer>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
